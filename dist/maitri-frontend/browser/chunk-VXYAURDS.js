import{a as Z}from"./chunk-QUBABJ3I.js";import"./chunk-RUFCWFVQ.js";import{a as X}from"./chunk-I4WMXEGQ.js";import{a as Y}from"./chunk-NTYYFM43.js";import{a as Q}from"./chunk-KDZEB7UL.js";import"./chunk-7B4WEPGY.js";import{a as H,c as O}from"./chunk-N7UIUSV4.js";import{C as K,c as G,g as U,l as J,o as q}from"./chunk-H56WTM6A.js";import"./chunk-DHV3KFP7.js";import"./chunk-VNHCDGQ4.js";import{$b as b,Gc as C,Hc as R,Ic as T,Jb as P,Ka as v,La as x,Lb as h,Vb as e,Wb as i,Xb as u,Ya as D,cc as g,ec as y,kd as A,lb as j,ma as M,oc as a,pc as S,qc as p,qd as N,ra as E,rb as l,rc as W,rd as L,sb as c,td as V,uc as k,vc as w,vd as F,wc as I,yc as z,za as B}from"./chunk-VIIRXEWM.js";function ie(){return window}var $=(()=>{let r=class r{constructor(t){this.platformId=t}get nativeWindow(){if(F(this.platformId))return ie()}};r.\u0275fac=function(o){return new(o||r)(E(D))},r.\u0275prov=M({token:r,factory:r.\u0275fac,providedIn:"root"});let s=r;return s})();function oe(s,r){if(s&1){let f=b();e(0,"span",43),g("click",function(){v(f);let o=y();return x(o.toggleBalance())}),a(1,"Check Balance"),i()}}function ae(s,r){if(s&1){let f=b();e(0,"span",43),g("click",function(){v(f);let o=y();return x(o.toggleBalance())}),a(1),i()}if(s&2){let f=y();l(),p("INR ",f.walletBalance,"")}}function re(s,r){s&1&&u(0,"i",44)}var Pe=(()=>{let r=class r{constructor(t,o,n,d,m,ee){this.route=t,this.userService=o,this.toastr=n,this.winRef=d,this.router=m,this.notificationService=ee,this.isCheckBalance=!1,this.isLoading=!1,this.selectedPaymentMethod="",this.route.params.subscribe(_=>{console.log("Param",_),this.appoinmentId=_.appoinmentId})}ngOnInit(){this.loadStripe(),this.getAppoinment(),this.getWalletBalance()}getAppoinment(){this.userService.GetAppointmentDetails(this.appoinmentId).subscribe({next:t=>{console.log(t),this.appoinmentDetails=t.data},error:t=>{this.toastr.error(t||"Error while Get Appoinments please try again")}})}makePayment(){if(!this.selectedPaymentMethod){this.toastr.warning("Please select Payment Method"),console.log("Please select a payment method.");return}if(this.selectedPaymentMethod!=="Wallet"&&this.selectedPaymentMethod!=="Debit Card"&&this.selectedPaymentMethod!=="PayPal"&&this.selectedPaymentMethod!=="Razorpay"&&this.selectedPaymentMethod!=="Stripe"){console.log("Invalid payment method selected."),this.toastr.warning("Invalid payment method selected");return}if(console.log("Selected payment method:",this.selectedPaymentMethod),this.isLoading=!0,this.selectedPaymentMethod==="Stripe")this.stripePaymentHandler();else if(this.selectedPaymentMethod==="Razorpay")this.processPayment();else if(this.selectedPaymentMethod==="Wallet")this.processPayment();else return}processPayment(t){this.userService.makePayment(this.selectedPaymentMethod,this.appoinmentId,t).subscribe({next:o=>{if(console.log(o),this.isLoading=!1,this.selectedPaymentMethod==="Stripe")this.router.navigate(["/booking-confirmation",o.data.appoinmentId]);else if(this.selectedPaymentMethod==="Razorpay")this.payWithRazorpay(o.data);else if(this.selectedPaymentMethod==="Wallet")this.router.navigate(["/booking-confirmation",o.data.appoinmentId]);else return},error:o=>{this.isLoading=!1,this.toastr.error(o)}})}stripePaymentHandler(){StripeCheckout.configure({key:Q.Stripe_Publishable_key,locale:"auto",token:o=>{console.log(o),this.processPayment(o)}}).open({name:"Edopedia.com Payment",description:"Some sample description of product",amount:this.appoinmentDetails.amount*100})}payWithRazorpay(t){let o={key:t.keyId,amount:t.amount,currency:"INR",name:"Maitri Consultation ",description:"Payment for your service",order_id:t.responseId,handler:d=>{this.verifyPayment(d.razorpay_order_id,d.razorpay_payment_id,d.razorpay_signature)},prefill:{name:"John Doe",email:"john@example.com",contact:"+919876543210"},notes:{address:"Razorpay Corporate Office"},theme:{color:"#3399cc"}};new this.winRef.nativeWindow.Razorpay(o).open()}verifyPayment(t,o,n){this.userService.verifyPayment(t,o,n,this.appoinmentDetails).subscribe({next:d=>{console.log("verify payment",d);let m=d.data.notificationId;this.notificationService.sendNotification(m),this.router.navigate(["/booking-confirmation",d.data.appoinmentId])},error:d=>{this.toastr.error(d)}})}loadStripe(){if(!window.document.getElementById("stripe-script")){let t=document.createElement("script");t.src="https://checkout.stripe.com/checkout.js",t.async=!0,t.onload=()=>{console.log("Stripe script loaded")},document.body.appendChild(t)}}getWalletBalance(){this.userService.getWalletBalance().subscribe({next:t=>{this.walletBalance=t.data},error:t=>{this.toastr.error(t)}})}toggleBalance(){this.isCheckBalance=!this.isCheckBalance}};r.\u0275fac=function(o){return new(o||r)(c(H),c(X),c(Y),c($),c(O),c(Z))},r.\u0275cmp=B({type:r,selectors:[["app-booking-checkout-page"]],standalone:!0,features:[z],decls:95,vars:22,consts:[[1,"grid","sm:px-10","lg:grid-cols-2","lg:px-14","xl:px-16"],[1,"px-4","pt-8"],[1,"text-xl","font-medium"],[1,"text-gray-400"],[1,"grid","gap-4","mt-10"],[1,"flex","relative","items-center","justify-center","bg-gray-100","rounded","px-4","py-8"],["class","absolute  top-1 right-1 hover:cursor-pointer inline-flex items-center justify-center px-2 py-1 bg-blue-500 text-white text-xs font-bold rounded-full ",3,"click",4,"ngIf"],["class","absolute top-1 right-1 hover:cursor-pointer inline-flex items-center justify-center px-2 py-1 bg-blue-500 text-white text-xs font-bold rounded-full ",3,"click",4,"ngIf"],["type","radio","id","Wallet","value","Wallet",1,"w-6","h-6","cursor-pointer",3,"ngModelChange","disabled","ngModel"],["for","Wallet",1,"ml-4","flex","gap-2","cursor-pointer"],["src","https://cdn.icon-icons.com/icons2/1103/PNG/512/wallet_78921.png","alt","Wallet",1,"w-28"],[1,"flex","items-center","justify-center","bg-gray-100","rounded","px-4","py-8"],["type","radio","id","razorpay","value","Razorpay",1,"w-6","h-6","cursor-pointer",3,"ngModelChange","ngModel"],["for","razorpay",1,"ml-4","flex","gap-2","cursor-pointer"],["src","https://www.vcbay.news/wp-content/uploads/2020/10/image-15.png","alt","Razorpay",1,"w-28"],[1,"lg:ms-5","mt-10","rounded-md","px-4","pt-8","lg:mt-0"],[1,"grid","grid-cols-1","gap-4"],[1,"col-span-1"],[1,"bg-white","shadow-lg","rounded-lg"],[1,"p-4"],[1,"flex","items-center"],[1,"flex-shrink-0","w-12","h-12"],["alt","Doctor",1,"w-full","h-full","rounded-full",3,"src"],[1,"ml-7"],[1,"text-lg","font-semibold"],["href","doctor-profile.html"],[1,"text-sm"],[1,"ml-auto"],[1,"mr-4","text-sm","text-green-500"],["href","doctor-profile-settings.html",1,"text-blue-500","hover:underline"],[1,"flex","flex-col","gap-2"],[1,"mb-2"],[1,"flex","justify-between"],[1,"font-semibold"],[1,"font-light","right-0"],[1,"p-2","flex","justify-end"],[1,"flex","items-center","justify-between"],[1,"text-sm","font-medium","text-gray-900"],[1,"font-semibold","text-gray-900"],[1,"mt-6","flex","items-center","border-t-2","border-black","pt-3","justify-between"],[1,"text-2xl","font-semibold","text-gray-900"],[1,"mt-4","mb-8","w-full","rounded-md","bg-blue-500","px-6","py-3","font-medium","text-white",3,"click"],["class","fas fa-spinner fa-spin mr-1",4,"ngIf"],[1,"absolute","top-1","right-1","hover:cursor-pointer","inline-flex","items-center","justify-center","px-2","py-1","bg-blue-500","text-white","text-xs","font-bold","rounded-full",3,"click"],[1,"fas","fa-spinner","fa-spin","mr-1"]],template:function(o,n){o&1&&(e(0,"div",0)(1,"div",1)(2,"p",2),a(3,"Payment Methods"),i(),e(4,"p",3),a(5,"Check your Appoinment. And select a suitable payment Method."),i(),e(6,"div",4)(7,"div",5),P(8,oe,2,0,"span",6)(9,ae,2,1,"span",7),e(10,"input",8),I("ngModelChange",function(m){return w(n.selectedPaymentMethod,m)||(n.selectedPaymentMethod=m),m}),i(),e(11,"label",9),u(12,"img",10),i()(),e(13,"div",11)(14,"input",12),I("ngModelChange",function(m){return w(n.selectedPaymentMethod,m)||(n.selectedPaymentMethod=m),m}),i(),e(15,"label",13),u(16,"img",14),i()()()(),e(17,"div",15)(18,"p",2),a(19,"Booking Summary"),i(),e(20,"p",3),a(21,"Complete your order by providing your payment details."),i(),e(22,"div",16)(23,"div",17)(24,"div",18)(25,"div",19)(26,"div",20)(27,"div",21),u(28,"img",22),i(),e(29,"div",23)(30,"h4",24)(31,"a",25),a(32),i()(),e(33,"p",26),a(34),i()(),e(35,"div",27),u(36,"i",28),e(37,"a",29),a(38,"Edit"),i()()()()()(),e(39,"div",17)(40,"div",18)(41,"div",19)(42,"ul",30)(43,"li",31)(44,"div",32)(45,"h4",33),a(46,"Booking Date:"),i(),e(47,"span",34),a(48),C(49,"date"),i()()(),e(50,"li",31)(51,"div",32)(52,"h4",33),a(53,"Booking Time: "),i(),e(54,"span",34),a(55),i()()(),e(56,"li",31)(57,"div",32)(58,"h4",33),a(59," Consultation Type:"),i(),e(60,"span",34),a(61),C(62,"titlecase"),i()()(),e(63,"li",31)(64,"div",32)(65,"h4",33),a(66," Duration:"),i(),e(67,"span",34),a(68),i()()()()(),u(69,"div",35),i()(),e(70,"div",17)(71,"div",18)(72,"div",19)(73,"ul",30)(74,"li",31)(75,"div",36)(76,"p",37),a(77," Consultation Fee:"),i(),e(78,"p",38),a(79),i()()(),e(80,"li",31)(81,"div",36)(82,"p",37),a(83,"Booking Fee"),i(),e(84,"p",38),a(85,"\u20B90.00"),i()()(),e(86,"li")(87,"div",39)(88,"p",37),a(89,"Total"),i(),e(90,"p",40),a(91),i()()()()()()()(),e(92,"button",41),g("click",function(){return n.makePayment()}),P(93,re,1,0,"i",42),a(94),i()()()),o&2&&(l(8),h("ngIf",!n.isCheckBalance),l(),h("ngIf",n.isCheckBalance),l(),h("disabled",n.walletBalance<n.appoinmentDetails.amount),k("ngModel",n.selectedPaymentMethod),l(4),k("ngModel",n.selectedPaymentMethod),l(14),h("src",n.appoinmentDetails.doctorInfo[0].profilePic,j),l(4),W("Dr.",n.appoinmentDetails.doctorInfo[0].firstName," ",n.appoinmentDetails.doctorInfo[0].lastName,""),l(2),S(n.appoinmentDetails.doctorSpecialization[0].name),l(14),p("",T(49,17,n.appoinmentDetails.date,"EEE, dd MMM yyyy")," "),l(7),S(n.appoinmentDetails.slot),l(6),p("",R(62,20,n.appoinmentDetails.typeOfAppointment)," Consulting"),l(7),p("",n.appoinmentDetails.duration," min "),l(11),p("\u20B9 ",n.appoinmentDetails.amount,""),l(12),p("\u20B9 ",n.appoinmentDetails.amount,".00"),l(2),h("ngIf",n.isLoading),l(),p("Proceed to Pay \u20B9",n.appoinmentDetails.amount,".00"))},dependencies:[V,A,N,L,K,G,q,U,J]});let s=r;return s})();export{Pe as BookingCheckoutPageComponent};
