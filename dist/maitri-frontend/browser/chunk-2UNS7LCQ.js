import{a as q}from"./chunk-6R5Y6IIL.js";import"./chunk-ECCWBJN3.js";import{a as V}from"./chunk-PDR5L2GK.js";import{a as J}from"./chunk-HYGX2NCD.js";import{a as U}from"./chunk-72ERA4KK.js";import"./chunk-7B4WEPGY.js";import{a as T,c as N}from"./chunk-TGHWUEU6.js";import{C as G,c as L,g as F,l as H,o as O}from"./chunk-CWHW6EFR.js";import"./chunk-J7J3MBJD.js";import"./chunk-RXVUTR5D.js";import{Aa as w,Hc as x,Ic as _,Jc as B,Kb as E,Mb as h,Wb as e,Xb as t,Yb as c,Za as I,dc as k,ld as j,mb as M,na as P,pc as o,qc as f,rc as u,rd as z,sa as b,sb as s,sc as C,sd as R,tb as p,ud as W,vc as y,wc as g,wd as A,xc as v,zc as D}from"./chunk-MMBRV4NV.js";function Y(){return window}var K=(()=>{let r=class r{constructor(i){this.platformId=i}get nativeWindow(){if(A(this.platformId))return Y()}};r.\u0275fac=function(a){return new(a||r)(b(I))},r.\u0275prov=P({token:r,factory:r.\u0275fac,providedIn:"root"});let m=r;return m})();function $(m,r){m&1&&c(0,"i",41)}var ue=(()=>{let r=class r{constructor(i,a,n,l,d,Q){this.route=i,this.userService=a,this.toastr=n,this.winRef=l,this.router=d,this.notificationService=Q,this.isLoading=!1,this.selectedPaymentMethod="",this.route.params.subscribe(S=>{console.log("Param",S),this.appoinmentId=S.appoinmentId})}ngOnInit(){this.loadStripe(),this.getAppoinment()}getAppoinment(){this.userService.GetAppointmentDetails(this.appoinmentId).subscribe({next:i=>{console.log(i),this.appoinmentDetails=i.data},error:i=>{this.toastr.error(i||"Error while Get Appoinments please try again")}})}makePayment(){if(!this.selectedPaymentMethod){this.toastr.warning("Please select Payment Method"),console.log("Please select a payment method.");return}if(this.selectedPaymentMethod!=="Debit Card"&&this.selectedPaymentMethod!=="PayPal"&&this.selectedPaymentMethod!=="Razorpay"&&this.selectedPaymentMethod!=="Stripe"){console.log("Invalid payment method selected."),this.toastr.warning("Invalid payment method selected");return}if(console.log("Selected payment method:",this.selectedPaymentMethod),this.isLoading=!0,this.selectedPaymentMethod==="Stripe")this.stripePaymentHandler();else if(this.selectedPaymentMethod==="Razorpay")this.processPayment();else return}processPayment(i){this.userService.makePayment(this.selectedPaymentMethod,this.appoinmentId,i).subscribe({next:a=>{if(console.log(a),this.isLoading=!1,this.selectedPaymentMethod==="Stripe")this.router.navigate(["/booking-confirmation",a.data.appoinmentId]);else if(this.selectedPaymentMethod==="Razorpay")this.payWithRazorpay(a.data);else return},error:a=>{this.isLoading=!1,this.toastr.error(a)}})}stripePaymentHandler(){StripeCheckout.configure({key:U.Stripe_Publishable_key,locale:"auto",token:a=>{console.log(a),this.processPayment(a)}}).open({name:"Edopedia.com Payment",description:"Some sample description of product",amount:this.appoinmentDetails.amount*100})}payWithRazorpay(i){let a={key:i.keyId,amount:i.amount,currency:"INR",name:"Maitri Consultation ",description:"Payment for your service",order_id:i.responseId,handler:l=>{this.verifyPayment(l.razorpay_order_id,l.razorpay_payment_id,l.razorpay_signature)},prefill:{name:"John Doe",email:"john@example.com",contact:"+919876543210"},notes:{address:"Razorpay Corporate Office"},theme:{color:"#3399cc"}};new this.winRef.nativeWindow.Razorpay(a).open()}verifyPayment(i,a,n){this.userService.verifyPayment(i,a,n,this.appoinmentDetails).subscribe({next:l=>{console.log("verify payment",l);let d=l.data.notificationId;this.notificationService.sendNotification(d),this.router.navigate(["/booking-confirmation",l.data.appoinmentId])},error:l=>{this.toastr.error(l)}})}loadStripe(){if(!window.document.getElementById("stripe-script")){let i=document.createElement("script");i.src="https://checkout.stripe.com/checkout.js",i.async=!0,i.onload=()=>{console.log("Stripe script loaded")},document.body.appendChild(i)}}getWalletBalance(){this.userService.getWalletBalance().subscribe({next:i=>{this.walletBalance=i.data},error:i=>{this.toastr.error(i)}})}};r.\u0275fac=function(a){return new(a||r)(p(T),p(V),p(J),p(K),p(N),p(q))},r.\u0275cmp=w({type:r,selectors:[["app-booking-checkout-page"]],standalone:!0,features:[D],decls:95,vars:19,consts:[[1,"grid","sm:px-10","lg:grid-cols-2","lg:px-14","xl:px-16"],[1,"px-4","pt-8"],[1,"text-xl","font-medium"],[1,"text-gray-400"],[1,"grid","gap-4","mt-10"],[1,"flex","items-center","justify-center","bg-gray-100","rounded","px-4","py-8"],[1,"absolute","top-1","right-1","hover:cursor-pointer","inline-flex","items-center","justify-center","px-2","py-1","bg-blue-500","text-white","text-xs","font-bold","rounded-full"],["type","radio","id","Wallet","value","Wallet",1,"w-6","h-6","cursor-pointer",3,"ngModelChange","ngModel"],["for","Wallet",1,"ml-4","flex","gap-2","cursor-pointer"],["src","https://cdn.icon-icons.com/icons2/1103/PNG/512/wallet_78921.png","alt","Wallet",1,"w-28"],["type","radio","id","razorpay","value","Razorpay",1,"w-6","h-6","cursor-pointer",3,"ngModelChange","ngModel"],["for","razorpay",1,"ml-4","flex","gap-2","cursor-pointer"],["src","https://www.vcbay.news/wp-content/uploads/2020/10/image-15.png","alt","Razorpay",1,"w-28"],[1,"lg:ms-5","mt-10","rounded-md","px-4","pt-8","lg:mt-0"],[1,"grid","grid-cols-1","gap-4"],[1,"col-span-1"],[1,"bg-white","shadow-lg","rounded-lg"],[1,"p-4"],[1,"flex","items-center"],[1,"flex-shrink-0","w-12","h-12"],["alt","Doctor",1,"w-full","h-full","rounded-full",3,"src"],[1,"ml-7"],[1,"text-lg","font-semibold"],["href","doctor-profile.html"],[1,"text-sm"],[1,"ml-auto"],[1,"mr-4","text-sm","text-green-500"],["href","doctor-profile-settings.html",1,"text-blue-500","hover:underline"],[1,"flex","flex-col","gap-2"],[1,"mb-2"],[1,"flex","justify-between"],[1,"font-semibold"],[1,"font-light","right-0"],[1,"p-2","flex","justify-end"],[1,"flex","items-center","justify-between"],[1,"text-sm","font-medium","text-gray-900"],[1,"font-semibold","text-gray-900"],[1,"mt-6","flex","items-center","border-t-2","border-black","pt-3","justify-between"],[1,"text-2xl","font-semibold","text-gray-900"],[1,"mt-4","mb-8","w-full","rounded-md","bg-blue-500","px-6","py-3","font-medium","text-white",3,"click"],["class","fas fa-spinner fa-spin mr-1",4,"ngIf"],[1,"fas","fa-spinner","fa-spin","mr-1"]],template:function(a,n){a&1&&(e(0,"div",0)(1,"div",1)(2,"p",2),o(3,"Payment Methods"),t(),e(4,"p",3),o(5,"Check your Appoinment. And select a suitable payment Method."),t(),e(6,"div",4)(7,"div",5)(8,"span",6),o(9,"Check Balance"),t(),e(10,"input",7),v("ngModelChange",function(d){return g(n.selectedPaymentMethod,d)||(n.selectedPaymentMethod=d),d}),t(),e(11,"label",8),c(12,"img",9),t()(),e(13,"div",5)(14,"input",10),v("ngModelChange",function(d){return g(n.selectedPaymentMethod,d)||(n.selectedPaymentMethod=d),d}),t(),e(15,"label",11),c(16,"img",12),t()()()(),e(17,"div",13)(18,"p",2),o(19,"Booking Summary"),t(),e(20,"p",3),o(21,"Complete your order by providing your payment details."),t(),e(22,"div",14)(23,"div",15)(24,"div",16)(25,"div",17)(26,"div",18)(27,"div",19),c(28,"img",20),t(),e(29,"div",21)(30,"h4",22)(31,"a",23),o(32),t()(),e(33,"p",24),o(34),t()(),e(35,"div",25),c(36,"i",26),e(37,"a",27),o(38,"Edit"),t()()()()()(),e(39,"div",15)(40,"div",16)(41,"div",17)(42,"ul",28)(43,"li",29)(44,"div",30)(45,"h4",31),o(46,"Booking Date:"),t(),e(47,"span",32),o(48),x(49,"date"),t()()(),e(50,"li",29)(51,"div",30)(52,"h4",31),o(53,"Booking Time: "),t(),e(54,"span",32),o(55),t()()(),e(56,"li",29)(57,"div",30)(58,"h4",31),o(59," Consultation Type:"),t(),e(60,"span",32),o(61),x(62,"titlecase"),t()()(),e(63,"li",29)(64,"div",30)(65,"h4",31),o(66," Duration:"),t(),e(67,"span",32),o(68),t()()()()(),c(69,"div",33),t()(),e(70,"div",15)(71,"div",16)(72,"div",17)(73,"ul",28)(74,"li",29)(75,"div",34)(76,"p",35),o(77," Consultation Fee:"),t(),e(78,"p",36),o(79),t()()(),e(80,"li",29)(81,"div",34)(82,"p",35),o(83,"Booking Fee"),t(),e(84,"p",36),o(85,"\u20B90.00"),t()()(),e(86,"li")(87,"div",37)(88,"p",35),o(89,"Total"),t(),e(90,"p",38),o(91),t()()()()()()()(),e(92,"button",39),k("click",function(){return n.makePayment()}),E(93,$,1,0,"i",40),o(94),t()()()),a&2&&(s(10),y("ngModel",n.selectedPaymentMethod),s(4),y("ngModel",n.selectedPaymentMethod),s(14),h("src",n.appoinmentDetails.doctorInfo[0].profilePic,M),s(4),C("Dr.",n.appoinmentDetails.doctorInfo[0].firstName," ",n.appoinmentDetails.doctorInfo[0].lastName,""),s(2),f(n.appoinmentDetails.doctorSpecialization[0].name),s(14),u("",B(49,14,n.appoinmentDetails.date,"EEE, dd MMM yyyy")," "),s(7),f(n.appoinmentDetails.slot),s(6),u("",_(62,17,n.appoinmentDetails.typeOfAppointment)," Consulting"),s(7),u("",n.appoinmentDetails.duration," min "),s(11),u("\u20B9 ",n.appoinmentDetails.amount,""),s(12),u("\u20B9 ",n.appoinmentDetails.amount,".00"),s(2),h("ngIf",n.isLoading),s(),u("Proceed to Pay \u20B9",n.appoinmentDetails.amount,".00"))},dependencies:[W,j,z,R,G,L,O,F,H]});let m=r;return m})();export{ue as BookingCheckoutPageComponent};
