import{c as me}from"./chunk-TQ63QEWC.js";import"./chunk-22UEK62H.js";import{a as x,b as Y,d as $}from"./chunk-5VGLTMZJ.js";import{a as se}from"./chunk-2DULAYXT.js";import"./chunk-VAQNUOTJ.js";import{a as re}from"./chunk-XDNE7C6I.js";import"./chunk-T6FY75RP.js";import{a as le}from"./chunk-OQKLRLHO.js";import{a as ae}from"./chunk-6CS5MZYZ.js";import"./chunk-7B4WEPGY.js";import{a as J,c as K}from"./chunk-FX3PANRP.js";import{B as ie,C as ne,D as oe,c as X,e as g,g as Z,l as ee,o as te}from"./chunk-YKYY62M2.js";import"./chunk-3UF7QMRJ.js";import"./chunk-Y6YHTU6Y.js";import{Fc as M,Gc as L,Hc as O,Ib as P,Ja as S,Ka as b,Kb as h,Ub as e,Vb as t,Wb as u,Xa as R,_b as w,bc as y,dc as v,jc as z,jd as q,kb as W,kc as T,lc as A,ma as B,nc as a,oc as C,pc as c,pd as Q,qb as s,qc as N,qd as G,ra as D,rb as d,sd as U,tc as I,uc as k,ud as H,vc as _,wc as F,xc as V,ya as j}from"./chunk-7CRQF3FF.js";function fe(){return window}var pe=(()=>{let r=class r{constructor(n){this.platformId=n}get nativeWindow(){if(H(this.platformId))return fe()}};r.\u0275fac=function(o){return new(o||r)(D(R))},r.\u0275prov=B({token:r,factory:r.\u0275fac,providedIn:"root"});let m=r;return m})();function ye(m,r){if(m&1){let f=w();e(0,"span",43),y("click",function(){S(f);let o=v();return b(o.toggleBalance())}),a(1,"Check Balance"),t()}}function ve(m,r){if(m&1){let f=w();e(0,"span",43),y("click",function(){S(f);let o=v();return b(o.toggleBalance())}),a(1),t()}if(m&2){let f=v();s(),c("INR ",f.walletBalance,"")}}function xe(m,r){m&1&&u(0,"i",44)}var Te=(()=>{let r=class r{constructor(n,o,i,l,p,de,ce,ue){this.route=n,this.userService=o,this.toastr=i,this.winRef=l,this.router=p,this.notificationService=de,this.fb=ce,this.stripeService=ue,this.isCheckBalance=!1,this.isLoading=!1,this.selectedPaymentMethod="",this.cardOptions={style:{base:{fontWeight:400,fontFamily:"Circular",fontSize:"14px",iconColor:"#666EE8",color:"#002333","::placeholder":{color:"#919191"}}}},this.elementsOptions={locale:"en",clientSecret:ae.STRIPE_SECRET_KEY},this.route.params.subscribe(E=>{console.log("Param",E),this.appoinmentId=E.appoinmentId})}ngOnInit(){this.getAppoinment(),this.getWalletBalance()}getAppoinment(){this.userService.GetAppointmentDetails(this.appoinmentId).subscribe({next:n=>{console.log("AppointmentDetails",n),this.appoinmentDetails=n.data,this.loadStripePayment()},error:n=>{this.toastr.error(n||"Error while Get Appoinments please try again")}})}makePayment(){if(!this.selectedPaymentMethod){this.toastr.warning("Please select Payment Method"),console.log("Please select a payment method.");return}if(this.selectedPaymentMethod!=="Wallet"&&this.selectedPaymentMethod!=="Debit Card"&&this.selectedPaymentMethod!=="PayPal"&&this.selectedPaymentMethod!=="Razorpay"&&this.selectedPaymentMethod!=="Stripe"){console.log("Invalid payment method selected."),this.toastr.warning("Invalid payment method selected");return}console.log("Selected payment method:",this.selectedPaymentMethod),this.isLoading=!0,this.processPayment()}processPayment(n){this.userService.makePayment(this.selectedPaymentMethod,this.appoinmentId,n).subscribe({next:o=>{if(console.log("After Payment",o),this.isLoading=!1,this.selectedPaymentMethod==="Stripe")location.href=`/booking-confirmation/${o.data.appointmentId}`;else if(this.selectedPaymentMethod==="Razorpay")this.payWithRazorpay(o.data);else if(this.selectedPaymentMethod==="Wallet")location.href=`/booking-confirmation/${o.data.appointmentId}`;else return},error:o=>{this.isLoading=!1,this.toastr.error(o)}})}stripePaymentHandler(){}payWithRazorpay(n){let o={key:n.keyId,amount:n.amount,currency:"INR",name:"Maitri Consultation ",description:"Payment for your service",order_id:n.responseId,handler:l=>{this.verifyPayment(l.razorpay_order_id,l.razorpay_payment_id,l.razorpay_signature)},prefill:{name:"John Doe",email:"john@example.com",contact:"+919876543210"},notes:{address:"Razorpay Corporate Office"},theme:{color:"#3399cc"}};new this.winRef.nativeWindow.Razorpay(o).open()}verifyPayment(n,o,i){this.userService.verifyPayment(n,o,i,this.appoinmentId).subscribe({next:l=>{console.log("verify payment",l);let p=l.data.notificationId;this.notificationService.sendNotification(p),location.href=`/booking-confirmation/${l.data.appointmentId}`},error:l=>{this.toastr.error(l)}})}getWalletBalance(){this.userService.getWalletBalance().subscribe({next:n=>{this.walletBalance=n.data},error:n=>{this.toastr.error(n)}})}toggleBalance(){this.isCheckBalance=!this.isCheckBalance}loadStripePayment(){this.stripeTest=this.fb.group({name:[`${this.appoinmentDetails.user[0].firstName} ${this.appoinmentDetails.user[0].lastName}`,[g.required]],email:[this.appoinmentDetails.user[0].email,[g.required]],amount:[this.appoinmentDetails.amount,[g.required,g.pattern(/\d+/)]]})}};r.\u0275fac=function(o){return new(o||r)(d(J),d(re),d(le),d(pe),d(K),d(se),d(ie),d(x))},r.\u0275cmp=j({type:r,selectors:[["app-booking-checkout-page"]],viewQuery:function(o,i){if(o&1&&z(Y,5),o&2){let l;T(l=A())&&(i.card=l.first)}},standalone:!0,features:[F([x]),V],decls:95,vars:22,consts:[[1,"grid","sm:px-10","lg:grid-cols-2","lg:px-14","xl:px-16"],[1,"px-4","pt-8"],[1,"text-xl","font-medium"],[1,"text-gray-400"],[1,"grid","gap-4","mt-10"],[1,"flex","relative","items-center","justify-center","bg-gray-100","rounded","px-4","py-8"],["class","absolute  top-1 right-1 hover:cursor-pointer inline-flex items-center justify-center px-2 py-1 bg-blue-500 text-white text-xs font-bold rounded-full ",3,"click",4,"ngIf"],["class","absolute top-1 right-1 hover:cursor-pointer inline-flex items-center justify-center px-2 py-1 bg-blue-500 text-white text-xs font-bold rounded-full ",3,"click",4,"ngIf"],["type","radio","id","Wallet","value","Wallet",1,"w-6","h-6","cursor-pointer",3,"ngModelChange","disabled","ngModel"],["for","Wallet",1,"ml-4","flex","gap-2","cursor-pointer"],["src","https://cdn.icon-icons.com/icons2/1103/PNG/512/wallet_78921.png","alt","Wallet",1,"w-28"],[1,"flex","items-center","justify-center","bg-gray-100","rounded","px-4","py-8"],["type","radio","id","razorpay","value","Razorpay",1,"w-6","h-6","cursor-pointer",3,"ngModelChange","ngModel"],["for","razorpay",1,"ml-4","flex","gap-2","cursor-pointer"],["src","https://www.vcbay.news/wp-content/uploads/2020/10/image-15.png","alt","Razorpay",1,"w-28"],[1,"lg:ms-5","mt-10","rounded-md","px-4","pt-8","lg:mt-0"],[1,"grid","grid-cols-1","gap-4"],[1,"col-span-1"],[1,"bg-white","shadow-lg","rounded-lg"],[1,"p-4"],[1,"flex","items-center"],[1,"flex-shrink-0","w-12","h-12"],["alt","Doctor",1,"w-full","h-full","rounded-full",3,"src"],[1,"ml-7"],[1,"text-lg","font-semibold"],["href","doctor-profile.html"],[1,"text-sm"],[1,"ml-auto"],[1,"mr-4","text-sm","text-green-500"],["href","doctor-profile-settings.html",1,"text-blue-500","hover:underline"],[1,"flex","flex-col","gap-2"],[1,"mb-2"],[1,"flex","justify-between"],[1,"font-semibold"],[1,"font-light","right-0"],[1,"p-2","flex","justify-end"],[1,"flex","items-center","justify-between"],[1,"text-sm","font-medium","text-gray-900"],[1,"font-semibold","text-gray-900"],[1,"mt-6","flex","items-center","border-t-2","border-black","pt-3","justify-between"],[1,"text-2xl","font-semibold","text-gray-900"],[1,"mt-4","mb-8","w-full","rounded-md","bg-blue-500","px-6","py-3","font-medium","text-white",3,"click"],["class","fas fa-spinner fa-spin mr-1",4,"ngIf"],[1,"absolute","top-1","right-1","hover:cursor-pointer","inline-flex","items-center","justify-center","px-2","py-1","bg-blue-500","text-white","text-xs","font-bold","rounded-full",3,"click"],[1,"fas","fa-spinner","fa-spin","mr-1"]],template:function(o,i){o&1&&(e(0,"div",0)(1,"div",1)(2,"p",2),a(3,"Payment Methods"),t(),e(4,"p",3),a(5,"Check your Appoinment. And select a suitable payment Method."),t(),e(6,"div",4)(7,"div",5),P(8,ye,2,0,"span",6)(9,ve,2,1,"span",7),e(10,"input",8),_("ngModelChange",function(p){return k(i.selectedPaymentMethod,p)||(i.selectedPaymentMethod=p),p}),t(),e(11,"label",9),u(12,"img",10),t()(),e(13,"div",11)(14,"input",12),_("ngModelChange",function(p){return k(i.selectedPaymentMethod,p)||(i.selectedPaymentMethod=p),p}),t(),e(15,"label",13),u(16,"img",14),t()()()(),e(17,"div",15)(18,"p",2),a(19,"Booking Summary"),t(),e(20,"p",3),a(21,"Complete your order by providing your payment details."),t(),e(22,"div",16)(23,"div",17)(24,"div",18)(25,"div",19)(26,"div",20)(27,"div",21),u(28,"img",22),t(),e(29,"div",23)(30,"h4",24)(31,"a",25),a(32),t()(),e(33,"p",26),a(34),t()(),e(35,"div",27),u(36,"i",28),e(37,"a",29),a(38,"Edit"),t()()()()()(),e(39,"div",17)(40,"div",18)(41,"div",19)(42,"ul",30)(43,"li",31)(44,"div",32)(45,"h4",33),a(46,"Booking Date:"),t(),e(47,"span",34),a(48),M(49,"date"),t()()(),e(50,"li",31)(51,"div",32)(52,"h4",33),a(53,"Booking Time: "),t(),e(54,"span",34),a(55),t()()(),e(56,"li",31)(57,"div",32)(58,"h4",33),a(59," Consultation Type:"),t(),e(60,"span",34),a(61),M(62,"titlecase"),t()()(),e(63,"li",31)(64,"div",32)(65,"h4",33),a(66," Duration:"),t(),e(67,"span",34),a(68),t()()()()(),u(69,"div",35),t()(),e(70,"div",17)(71,"div",18)(72,"div",19)(73,"ul",30)(74,"li",31)(75,"div",36)(76,"p",37),a(77," Consultation Fee:"),t(),e(78,"p",38),a(79),t()()(),e(80,"li",31)(81,"div",36)(82,"p",37),a(83,"Booking Fee"),t(),e(84,"p",38),a(85,"\u20B90.00"),t()()(),e(86,"li")(87,"div",39)(88,"p",37),a(89,"Total"),t(),e(90,"p",40),a(91),t()()()()()()()(),e(92,"button",41),y("click",function(){return i.makePayment()}),P(93,xe,1,0,"i",42),a(94),t()()()),o&2&&(s(8),h("ngIf",!i.isCheckBalance),s(),h("ngIf",i.isCheckBalance),s(),h("disabled",i.walletBalance<i.appoinmentDetails.amount),I("ngModel",i.selectedPaymentMethod),s(4),I("ngModel",i.selectedPaymentMethod),s(14),h("src",i.appoinmentDetails.doctorInfo[0].profilePic,W),s(4),N("Dr.",i.appoinmentDetails.doctorInfo[0].firstName," ",i.appoinmentDetails.doctorInfo[0].lastName,""),s(2),C(i.appoinmentDetails.doctorSpecialization[0].name),s(14),c("",O(49,17,i.appoinmentDetails.date,"EEE, dd MMM yyyy")," "),s(7),C(i.appoinmentDetails.slot),s(6),c("",L(62,20,i.appoinmentDetails.typeOfAppointment)," Consulting"),s(7),c("",i.appoinmentDetails.duration," min "),s(11),c("\u20B9 ",i.appoinmentDetails.amount,""),s(12),c("\u20B9 ",i.appoinmentDetails.amount,".00"),s(2),h("ngIf",i.isLoading),s(),c("Proceed to Pay \u20B9",i.appoinmentDetails.amount,".00"))},dependencies:[$,U,q,Q,G,ne,X,te,Z,ee,me,oe]});let m=r;return m})();export{Te as BookingCheckoutPageComponent};
